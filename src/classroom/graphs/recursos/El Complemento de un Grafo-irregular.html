<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Complemento de un Grafo: Invirtiendo las Conexiones</title>
    <style>
        /* --- ESTILOS GENERALES Y TEMATIZACI√ìN --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-primary: linear-gradient(135deg, #1e1b4b 0%, #15803d 100%);
            --bg-secondary: rgba(255, 255, 255, 0.9);
            --text-primary: #111827;
            --text-secondary: #374151;
            --accent-primary: #166534;
            --accent-secondary: #312e81;
            --accent-highlight: #f59e0b;
            --card-bg: rgba(255, 255, 255, 0.85);
            --border-color: rgba(0, 0, 0, 0.1);
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
            --transition: all 0.3s ease-in-out;
        }
        [data-theme="dark"] {
            --bg-primary: linear-gradient(135deg, #0c192c 0%, #172a4f 100%);
            --bg-secondary: rgba(15, 23, 42, 0.9);
            --text-primary: #e5e7eb;
            --text-secondary: #9ca3af;
            --accent-primary: #22c55e;
            --accent-secondary: #818cf8;
            --accent-highlight: #fcd34d;
            --card-bg: rgba(30, 41, 59, 0.85);
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg-primary); color: var(--text-primary);
            min-height: 100vh; overflow-x: hidden; position: relative;
            line-height: 1.7; transition: var(--transition);
        }

        /* --- BURBUJAS DE FONDO --- */
        .bubbles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        .bubble { position: absolute; bottom: -150px; background: rgba(255, 255, 255, 0.05); border-radius: 50%; animation: rise 40s infinite ease-in; }
        @keyframes rise {
            0% { transform: translateY(0); opacity: 0; }
            10% { opacity: 0.4; }
            90% { opacity: 0.4; }
            100% { transform: translateY(-100vh); opacity: 0; }
        }

        /* --- LAYOUT Y CONTENEDORES --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem; position: relative; z-index: 1; }
        .header { text-align: center; margin-bottom: 3rem; }
        .main-title {
            font-size: clamp(2.5rem, 5vw, 3.8rem); font-weight: 800;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; margin-bottom: 1rem; color: white;
        }
        [data-theme="light"] .main-title { color: var(--text-primary); }
        .subtitle { font-size: 1.2rem; color: var(--text-secondary); max-width: 800px; margin: 0 auto; }
        .card {
            background: var(--card-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--border-color); border-radius: 20px; padding: 2.5rem;
            margin-bottom: 2.5rem; box-shadow: var(--shadow); transition: var(--transition);
        }
        .card:hover { transform: translateY(-5px); }
        h2 { font-size: 2rem; color: var(--accent-primary); margin-bottom: 1.5rem; }
        h3 { font-size: 1.5rem; color: var(--text-primary); margin: 2rem 0 1rem; }

        /* --- FORMATO DE TEXTO Y BLOQUES ESPECIALES --- */
        .formula {
            background: rgba(0, 0, 0, 0.05); border-left: 4px solid var(--accent-secondary);
            padding: 1rem; margin: 1rem 0; border-radius: 8px;
            font-family: 'SF Mono', 'Fira Code', 'JetBrains Mono', monospace; overflow-x: auto;
        }
        [data-theme="dark"] .formula { background: rgba(0, 0, 0, 0.2); }
        code {
            background-color: rgba(22, 101, 52, 0.1); color: var(--accent-primary);
            padding: 0.2em 0.4em; border-radius: 5px; font-family: 'SF Mono', 'Fira Code', monospace;
        }
        strong { color: var(--accent-primary); }
        .key-concept {
            border: 2px solid var(--accent-highlight); border-radius: 15px; padding: 1.5rem;
            margin-top: 2rem; background: rgba(245, 158, 11, 0.05);
        }
        .key-concept h3 { margin-top: 0; color: var(--accent-highlight); }

        /* --- LABORATORIO INTERACTIVO --- */
        .lab { text-align: center; }
        .lab-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; align-items: start;
        }
        .graph-container {
            border: 1px solid var(--border-color); border-radius: 15px;
            padding: 1rem; background: rgba(0,0,0,0.05);
        }
        [data-theme="dark"] .graph-container { background: rgba(0,0,0,0.2); }
        .graph-canvas { width: 100%; height: auto; cursor: pointer; }
        .info-panel { font-family: 'SF Mono', monospace; font-size: 0.9em; }
        .lab-controls { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1rem; justify-content: center; }
        .lab-controls button {
            padding: 0.6rem 1rem; font-size: 0.9rem; border: 1px solid var(--border-color);
            border-radius: 8px; background-color: var(--card-bg); color: var(--text-primary);
            cursor: pointer; transition: var(--transition);
        }
        .lab-controls button:hover { background-color: var(--accent-primary); color: white; }
        @media (max-width: 800px) { .lab-grid { grid-template-columns: 1fr; } }
        
        /* --- DIAGRAMA EXPLICATIVO --- */
        .degree-diagram {
            display: flex; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.05); padding: 2rem; border-radius: 15px;
            font-family: 'SF Mono', monospace;
        }
        [data-theme="dark"] .degree-diagram { background: rgba(0,0,0,0.2); }
        .degree-box { text-align: center; }
        .arrow { font-size: 2rem; color: var(--accent-secondary); margin: 0 2rem; }

        /* --- OTROS --- */
        .theme-toggle {
            position: fixed; top: 1.5rem; right: 1.5rem; width: 50px; height: 50px;
            border-radius: 50%; background: var(--card-bg); border: 1px solid var(--border-color);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; color: var(--accent-primary); transition: var(--transition); z-index: 1000;
        }
        .theme-toggle:hover { transform: scale(1.1) rotate(360deg); box-shadow: var(--shadow); }
        footer { text-align: center; padding: 2rem; margin-top: 2rem; color: rgba(255,255,255,0.8); }
    </style>
</head>
<body data-theme="dark">

    <div class="bubbles" id="bubbles-container"></div>
    <button class="theme-toggle" id="theme-toggle-btn" title="Cambiar tema">üåô</button>

    <div class="container">
        <header class="header">
            <h1 class="main-title">El Complemento de un Grafo</h1>
            <p class="subtitle">Una de las transformaciones m√°s fundamentales en la teor√≠a de grafos, que consiste en "voltear" todas las conexiones para revelar una estructura dual.</p>
        </header>

        <section class="card">
            <h2>¬øQu√© es el Complemento de un Grafo?</h2>
            <p>Para un grafo simple <code>G = (V, E)</code>, su complemento, denotado como <strong><code>GÃÖ</code></strong>, es un grafo con el mismo conjunto de v√©rtices <code>V</code>, pero su conjunto de aristas est√° formado por todos los pares de v√©rtices que <strong>no</strong> estaban conectados en <code>G</code>.</p>
            <p>Por ejemplo, el complemento del grafo completo <code>K‚Çô</code> (donde todas las aristas existen) es el grafo nulo <code>N‚Çô</code> (donde no existe ninguna arista), y viceversa.</p>
        </section>
        
        <section class="card lab">
            <h2>Laboratorio Interactivo del Complemento</h2>
            <p>Haz clic entre dos v√©rtices en el Grafo G para a√±adir o quitar una arista. Observa c√≥mo el Grafo GÃÖ se actualiza instant√°neamente. Utiliza los botones para cargar ejemplos.</p>
            <div class="lab-grid">
                <div class="graph-container">
                    <h3>Grafo G</h3>
                    <canvas class="graph-canvas" id="graph-g-canvas" width="500" height="500"></canvas>
                    <div class="info-panel">
                        <p><strong>Aristas:</strong> <span id="g-edges">0</span> / 10</p>
                        <p><strong>Grados:</strong> <span id="g-degrees"></span></p>
                    </div>
                </div>
                <div class="graph-container">
                    <h3>Complemento GÃÖ</h3>
                    <canvas class="graph-canvas" id="graph-gbar-canvas" width="500" height="500"></canvas>
                     <div class="info-panel">
                        <p><strong>Aristas:</strong> <span id="gbar-edges">10</span> / 10</p>
                        <p><strong>Grados:</strong> <span id="gbar-degrees"></span></p>
                    </div>
                </div>
            </div>
            <div class="lab-controls">
                <button data-graph="empty">Vaciar</button>
                <button data-graph="c5">Ciclo C‚ÇÖ</button>
                <button data-graph="p5">Camino P‚ÇÖ</button>
                <button data-graph="k5">Completo K‚ÇÖ</button>
                <button data-graph="nearly_irr">Casi Irregular n=5</button>
            </div>
        </section>

        <section class="card">
            <h2>F√≥rmulas y Propiedades del Complemento</h2>
            <p>La operaci√≥n de inversi√≥n tiene consecuencias directas y predecibles.</p>
            <h3>Relaci√≥n de Grados</h3>
            <p>Esta es la relaci√≥n m√°s importante. Como hay <code>n-1</code> conexiones posibles para cualquier v√©rtice, su grado en <code>GÃÖ</code> es el total de conexiones posibles menos las que ya ten√≠a en <code>G</code>:</p>
            <div class="formula">deg_GÃÖ(v) = (n-1) - deg_G(v)</div>
            <div class="degree-diagram">
                <div class="degree-box">deg_G(v) = <strong>d</strong></div>
                <div class="arrow">‚Üî</div>
                <div class="degree-box">deg_GÃÖ(v) = <strong>(n-1) - d</strong></div>
            </div>
            <h3>Relaci√≥n de Aristas</h3>
            <p>El n√∫mero total de aristas posibles en un grafo simple de orden <code>n</code> es <code>n(n-1)/2</code>. El n√∫mero de aristas en el complemento es este total menos las aristas de <code>G</code>:</p>
            <div class="formula">|E(GÃÖ)| = n(n-1)/2 - |E(G)|</div>
        </section>

        <section class="card">
            <h2>Aplicaci√≥n a Grafos Casi Irregulares</h2>
            <h3>¬øPor qu√© el Complemento Preserva la "Casi Irregularidad"?</h3>
            <p>Un grafo casi irregular tiene exactamente un par de v√©rtices con el mismo grado. La transformaci√≥n de grados <code>d ‚Ü¶ (n-1) - d</code> es una <strong>biyecci√≥n</strong>, lo que significa que es una correspondencia uno a uno que no crea ni destruye coincidencias de grado:</p>
            <ul>
                <li>Si <code>deg_G(u) = deg_G(v)</code>, entonces sus grados en el complemento tambi√©n ser√°n iguales.</li>
                <li>Si <code>deg_G(u) ‚â† deg_G(v)</code>, entonces sus grados en el complemento tambi√©n ser√°n distintos.</li>
            </ul>
            <p>Por lo tanto, si <code>G</code> ten√≠a exactamente un par de grados repetidos, <code>GÃÖ</code> tambi√©n lo tendr√°, lo que lo convierte en un grafo casi irregular.</p>
            
            <h3>¬øPor qu√© los dos √∫nicos Casi Irregulares deben ser Complementarios?</h3>
            <p>Este es un elegante argumento l√≥gico. Sabemos que para cada orden <code>n</code>, existen <strong>exactamente dos</strong> grafos casi irregulares. Llam√©moslos <code>G</code> y <code>H</code>.</p>
            <ol>
                <li>La operaci√≥n de complemento es su propia inversa (<code>GÃø = G</code>).</li>
                <li>Como el complemento de un casi irregular es otro casi irregular, esta operaci√≥n mapea el conjunto <code>{G, H}</code> a s√≠ mismo.</li>
                <li>Un grafo casi irregular no puede ser autocomplementario (<code>G ‚âá GÃÖ</code>), porque si <code>G</code> tiene un v√©rtice de grado 0, <code>GÃÖ</code> debe tener uno de grado <code>n-1</code>, y viceversa. Un grafo no puede tener ambos a la vez.</li>
                <li>Dado que el complemento no puede mapear <code>G</code> a <code>G</code> ni <code>H</code> a <code>H</code>, la √∫nica posibilidad que queda es que los intercambie: <strong><code>GÃÖ ‚âÖ H</code></strong>.</li>
            </ol>
        </section>
        
        <footer>
            <p>Material elaborado por el profesor Sergio Gevatschnaider</p>
        </footer>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- M√ìDULO 1: UI ---
        const themeToggleBtn = document.getElementById('theme-toggle-btn');
        // (C√≥digo de tema y burbujas omitido por brevedad, es el mismo de las versiones anteriores)
        set_theme(localStorage.getItem('theme') || 'dark');

        function set_theme(theme) {
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            themeToggleBtn.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }
        themeToggleBtn.addEventListener('click', () => {
            const new_theme = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
            set_theme(new_theme);
        });

        // --- M√ìDULO 2: CLASE DEL LABORATORIO ---
        class ComplementLab {
            constructor(canvasGId, canvasGBarId, n=5) {
                this.canvasG = document.getElementById(canvasGId);
                this.ctxG = this.canvasG.getContext('2d');
                this.canvasGBar = document.getElementById(canvasGBarId);
                this.ctxGBar = this.canvasGBar.getContext('2d');
                this.n = n;
                this.nodeRadius = 15;
                this.selectedNode = null;
                this.init();
                this.canvasG.addEventListener('click', this.handleClick.bind(this));
            }

            init() {
                this.nodes = [];
                const centerX = this.canvasG.width / 2;
                const centerY = this.canvasG.height / 2;
                const radius = Math.min(centerX, centerY) * 0.8;
                for (let i = 0; i < this.n; i++) {
                    this.nodes.push({
                        x: centerX + radius * Math.cos(2 * Math.PI * i / this.n - Math.PI / 2),
                        y: centerY + radius * Math.sin(2 * Math.PI * i / this.n - Math.PI / 2)
                    });
                }
                this.edges = new Set();
                this.drawAll();
            }

            _getThemeColors() {
                return {
                    node: getComputedStyle(document.documentElement).getPropertyValue('--accent-primary').trim(),
                    edge: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary').trim(),
                    label: getComputedStyle(document.documentElement).getPropertyValue('--card-bg').trim(),
                    highlight: getComputedStyle(document.documentElement).getPropertyValue('--accent-highlight').trim()
                };
            }

            loadPreset(type) {
                this.edges.clear();
                const presets = {
                    c5: [[0,1],[1,2],[2,3],[3,4],[4,0]],
                    p5: [[0,1],[1,2],[2,3],[3,4]],
                    k5: [[0,1],[0,2],[0,3],[0,4],[1,2],[1,3],[1,4],[2,3],[2,4],[3,4]],
                    nearly_irr: [[0,1],[0,2],[0,3],[1,2],[2,4]] // Realizaci√≥n de (3,2,2,1,0)
                };
                if(presets[type]){
                    presets[type].forEach(([u, v]) => this.toggleEdge(u, v));
                }
                this.drawAll();
            }

            handleClick(event) {
                const rect = this.canvasG.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;

                for (let i = 0; i < this.n; i++) {
                    const node = this.nodes[i];
                    const dist = Math.sqrt((x - node.x)**2 + (y - node.y)**2);
                    if (dist < this.nodeRadius + 5) {
                        if (this.selectedNode === null) {
                            this.selectedNode = i;
                        } else {
                            if (this.selectedNode !== i) {
                                this.toggleEdge(this.selectedNode, i);
                                this.drawAll();
                            }
                            this.selectedNode = null;
                        }
                        this.drawAll(); // Redraw to show selection
                        return;
                    }
                }
                this.selectedNode = null;
                this.drawAll();
            }

            toggleEdge(u, v) {
                const key = `${Math.min(u, v)}-${Math.max(u, v)}`;
                if (this.edges.has(key)) {
                    this.edges.delete(key);
                } else {
                    this.edges.add(key);
                }
            }
            
            _drawGraph(ctx, edges) {
                const colors = this._getThemeColors();
                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);

                ctx.strokeStyle = colors.edge;
                ctx.lineWidth = 2.5;
                edges.forEach(key => {
                    const [u, v] = key.split('-').map(Number);
                    ctx.beginPath();
                    ctx.moveTo(this.nodes[u].x, this.nodes[u].y);
                    ctx.lineTo(this.nodes[v].x, this.nodes[v].y);
                    ctx.stroke();
                });
                
                this.nodes.forEach((node, i) => {
                    ctx.beginPath();
                    ctx.arc(node.x, node.y, this.nodeRadius, 0, 2 * Math.PI);
                    ctx.fillStyle = colors.node;
                    ctx.fill();
                    if(this.selectedNode === i && ctx === this.ctxG){
                       ctx.strokeStyle = colors.highlight;
                       ctx.lineWidth = 4;
                       ctx.stroke();
                    }
                });
            }
            
            drawAll() {
                // Draw G
                this._drawGraph(this.ctxG, this.edges);
                
                // Draw G_bar
                const complementEdges = new Set();
                for (let i = 0; i < this.n; i++) {
                    for (let j = i + 1; j < this.n; j++) {
                        const key = `${i}-${j}`;
                        if (!this.edges.has(key)) {
                            complementEdges.add(key);
                        }
                    }
                }
                this._drawGraph(this.ctxGBar, complementEdges);
                this.updateInfo(this.edges, complementEdges);
            }
            
            updateInfo(g_edges, gbar_edges) {
                const getDegrees = (num_nodes, edge_set) => {
                    const degrees = Array(num_nodes).fill(0);
                    edge_set.forEach(key => {
                        const [u, v] = key.split('-').map(Number);
                        degrees[u]++;
                        degrees[v]++;
                    });
                    return degrees;
                };

                const g_degrees = getDegrees(this.n, g_edges);
                const gbar_degrees = getDegrees(this.n, gbar_edges);

                document.getElementById('g-edges').textContent = `${g_edges.size} / ${this.n * (this.n - 1) / 2}`;
                document.getElementById('g-degrees').textContent = g_degrees.join(', ');
                document.getElementById('gbar-edges').textContent = `${gbar_edges.size} / ${this.n * (this.n - 1) / 2}`;
                document.getElementById('gbar-degrees').textContent = gbar_degrees.join(', ');
            }
        }

        // --- M√ìDULO 3: CONTROLADOR ---
        const lab = new ComplementLab('graph-g-canvas', 'graph-gbar-canvas', 5);
        document.querySelectorAll('.lab-controls button').forEach(btn => {
            btn.addEventListener('click', () => lab.loadPreset(btn.dataset.graph));
        });
        
        const themeObserver = new MutationObserver(() => lab.drawAll());
        themeObserver.observe(document.body, { attributes: true, attributeFilter: ['data-theme'] });
    });
    </script>
</body>
</html>