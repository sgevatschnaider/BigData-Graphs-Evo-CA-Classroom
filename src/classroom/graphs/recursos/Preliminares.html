<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teoría de Grafos - Visualización Interactiva</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-secondary: rgba(255, 255, 255, 0.95);
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --accent: #4299e1;
            --card-bg: rgba(255, 255, 255, 0.9);
            --border: rgba(255, 255, 255, 0.3);
            --shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }

        [data-theme="dark"] {
            --bg-primary: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            --bg-secondary: rgba(45, 55, 72, 0.95);
            --text-primary: #f7fafc;
            --text-secondary: #e2e8f0;
            --accent: #63b3ed;
            --card-bg: rgba(45, 55, 72, 0.9);
            --border: rgba(255, 255, 255, 0.1);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            transition: background 0.5s ease, color 0.5s ease;
        }

        /* Burbujas animadas */
        .bubbles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            opacity: 0.6;
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            20% {
                opacity: 0.6;
            }
            80% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        /* Header y navegación */
        .header {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            background: var(--bg-secondary);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
        }

        .theme-toggle {
            background: var(--accent);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .theme-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(66, 153, 225, 0.4);
        }

        /* Contenido principal */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 100px 2rem 2rem;
            position: relative;
            z-index: 1;
        }

        .hero {
            text-align: center;
            margin-bottom: 3rem;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 3rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, var(--accent), #9f7aea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 800px;
            margin: 0 auto;
        }

        .section {
            margin-bottom: 3rem;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: transform 0.3s ease;
        }

        .section:hover {
            transform: translateY(-5px);
        }

        .section h2 {
            color: var(--accent);
            margin-bottom: 1.5rem;
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-icon {
            width: 40px;
            height: 40px;
            background: var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .graph-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .graph-card {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }
        
        [data-theme="dark"] .graph-card {
            background: rgba(255, 255, 255, 0.05);
        }

        .graph-card:hover {
            background: rgba(0, 0, 0, 0.08);
            transform: scale(1.02);
        }

        .graph-canvas {
            width: 100%;
            height: 250px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.05);
            margin-bottom: 1rem;
        }
         [data-theme="dark"] .graph-canvas {
            background: rgba(0, 0, 0, 0.2);
        }

        /* Fórmulas matemáticas */
        .formula {
            background: rgba(66, 153, 225, 0.1);
            border-left: 4px solid var(--accent);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            overflow-x: auto;
        }

        .highlight {
            background: linear-gradient(120deg, rgba(66, 153, 225, 0.3) 0%, rgba(66, 153, 225, 0.1) 100%);
            padding: 0.2rem 0.5rem;
            border-radius: 5px;
            font-weight: bold;
        }

        /* Visualizaciones interactivas */
        .interactive-demo {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }
        
        [data-theme="dark"] .interactive-demo {
             background: rgba(0, 0, 0, 0.2);
        }

        .demo-button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            margin: 0.5rem;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(66, 153, 225, 0.4);
        }

        .graph-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        #handshakeResult {
             transition: all 0.3s ease;
        }
        
        #handshakeResult:empty {
            padding: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.2rem;
            }
            .hero p {
                font-size: 1rem;
            }
            .container {
                padding: 80px 1rem 1rem;
            }
            .header {
                 padding: 1rem;
            }
        }

        /* Efectos de scroll */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <div class="bubbles" id="bubbles"></div>
    
    <header class="header">
        <div class="nav-container">
            <div class="logo">📊 Teoría de Grafos</div>
            <button class="theme-toggle" id="theme-toggle">🌙 Tema Oscuro</button>
        </div>
    </header>

    <div class="container">
        <section class="hero fade-in">
            <h1>Preliminares y Notación en Teoría de Grafos: Un Enfoque Didáctico</h1>
            <p>En el vasto universo de las matemáticas y las ciencias de la computación, la teoría de grafos se erige como un pilar fundamental para modelar y analizar relaciones entre objetos. Explora los conceptos fundamentales con visualizaciones interactivas.</p>
        </section>

        <section class="section fade-in">
            <h2><span class="section-icon">🔗</span>Tipos Fundamentales de Grafos</h2>
            
            <div class="graph-container">
                <div class="graph-card">
                    <h3>Grafos Simples</h3>
                    <canvas class="graph-canvas" id="simpleGraph"></canvas>
                    <p>Un grafo se considera <span class="highlight">simple</span> si no tiene lazos (aristas que conectan un vértice consigo mismo) y no existen múltiples aristas entre el mismo par de vértices. La mayoría de los problemas introductorios se centran en este tipo por su sencillez.</p>
                </div>

                <div class="graph-card">
                    <h3>Multigrafos</h3>
                    <canvas class="graph-canvas" id="multiGraph"></canvas>
                    <p>En los <span class="highlight">multigrafos</span>, se permiten aristas paralelas o múltiples, es decir, más de una arista puede conectar el mismo par de vértices. Esto es útil para modelar escenarios donde existen múltiples conexiones o rutas directas entre dos puntos.</p>
                </div>

                <div class="graph-card">
                    <h3>Grafos Ponderados</h3>
                    <canvas class="graph-canvas" id="weightedGraph"></canvas>
                    <p>En los <span class="highlight">grafos ponderados</span>, a cada arista se le asigna un valor numérico o "peso". Este peso puede representar distancia, costo, tiempo, o cualquier otra métrica relevante.</p>
                </div>
            </div>
        </section>

        <section class="section fade-in">
            <h2><span class="section-icon">📐</span>Grado y Secuencia de Grados</h2>
            
            <p>Una de las propiedades más básicas y a la vez más informativas de un vértice es su <span class="highlight">grado</span>. El grado de un vértice, denotado como deg(v), es simplemente el número de aristas que inciden en él.</p>

            <div class="interactive-demo">
                <h3>Demostración Interactiva: Calculando Grados</h3>
                <canvas id="degreeDemo" width="600" height="300" style="max-width: 100%; border-radius: 10px;"></canvas>
                <div>
                    <button class="demo-button" id="generateGraphBtn">Generar Grafo Aleatorio</button>
                    <button class="demo-button" id="showDegreesBtn">Mostrar Grados</button>
                </div>
                <div class="graph-stats" id="graphStats"></div>
            </div>

            <div class="formula">
                <strong>Secuencia de Grados:</strong> Lista de los grados de todos los vértices del grafo, generalmente ordenada de forma no decreciente.<br>
                Ejemplo: [1, 2, 2, 3]
            </div>
        </section>

        <section class="section fade-in">
            <h2><span class="section-icon">🤝</span>El Lema del Apretón de Manos</h2>
            
            <p>Este lema fundamental establece que la suma de los grados de todos los vértices de un grafo es igual al doble del número de aristas. Una consecuencia directa es que el número de vértices con grado impar siempre debe ser par.</p>

            <div class="formula">
                <strong>Lema:</strong> Σ deg(v) = 2 |E|
            </div>

            <div class="interactive-demo">
                <h3>Verificación del Lema</h3>
                <canvas id="handshakeDemo" width="600" height="300" style="max-width: 100%; border-radius: 10px;"></canvas>
                <div>
                    <button class="demo-button" id="verifyHandshakeBtn">Verificar Lema</button>
                    <button class="demo-button" id="showParityBtn">Verificar Paridad de Grados</button>
                </div>
                <div id="handshakeResult" style="margin-top: 1rem; font-size: 1.2rem; font-weight: bold; color: var(--accent);"></div>
            </div>
        </section>

        <section class="section fade-in">
            <h2><span class="section-icon">⚖️</span>Regularidad e Irregularidad</h2>
            
            <p>El concepto de grado es central para definir un grafo <span class="highlight">regular</span>, aquel en el que todos sus vértices tienen el mismo grado. En el extremo opuesto, un grafo es <span class="highlight">irregular</span> si sus vértices tienen grados distintos.</p>

            <div class="graph-container">
                <div class="graph-card">
                    <h3>Grafo 3-Regular</h3>
                    <canvas class="graph-canvas" id="regularGraph"></canvas>
                    <p>Un grafo <span class="highlight">k-regular</span> es aquel en el que todos sus vértices tienen un grado igual a 'k'. Este es un ejemplo de un grafo 3-regular.</p>
                </div>

                <div class="graph-card">
                    <h3>Grafo Irregular</h3>
                    <canvas class="graph-canvas" id="irregularGraph"></canvas>
                    <p>Un grafo <span class="highlight">irregular</span> es aquel que no es regular. El caso extremo es un grafo "completamente irregular", donde todos los vértices tienen grados diferentes.</p>
                </div>
            </div>
        </section>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        // --- SETUP INICIAL ---

        // 1. Inicializar Burbujas
        createBubbles();

        // 2. Lógica del cambio de tema
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('click', () => {
            const body = document.body;
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                themeToggle.innerHTML = '🌙 Tema Oscuro';
            } else {
                body.setAttribute('data-theme', 'dark');
                themeToggle.innerHTML = '☀️ Tema Claro';
            }
        });

        // 3. Animaciones de scroll
        const scrollElements = document.querySelectorAll('.fade-in');
        const handleScrollAnimations = () => {
            scrollElements.forEach(el => {
                if (el.getBoundingClientRect().top < window.innerHeight - 100) {
                    el.classList.add('visible');
                }
            });
        };
        window.addEventListener('scroll', handleScrollAnimations);
        handleScrollAnimations(); // Para elementos ya visibles

        // 4. Dibujar grafos estáticos iniciales
        new GraphDrawer(document.getElementById('simpleGraph')).drawSimpleGraph();
        new GraphDrawer(document.getElementById('multiGraph')).drawMultiGraph();
        new GraphDrawer(document.getElementById('weightedGraph')).drawWeightedGraph();
        new GraphDrawer(document.getElementById('regularGraph')).drawRegularGraph();
        new GraphDrawer(document.getElementById('irregularGraph')).drawIrregularGraph();
        
        // 5. Setup de demostraciones interactivas
        const degreeDemoDrawer = new GraphDrawer(document.getElementById('degreeDemo'));
        const handshakeDemoDrawer = new GraphDrawer(document.getElementById('handshakeDemo'));

        const generateRandomGraphForDemo = (drawer) => {
            const canvas = drawer.canvas;
            const width = canvas.width;
            const height = canvas.height;
            drawer.clear();
            
            const numNodes = 5 + Math.floor(Math.random() * 4);
            for (let i = 0; i < numNodes; i++) {
                const x = 40 + Math.random() * (width - 80);
                const y = 40 + Math.random() * (height - 80);
                drawer.addNode(x, y, String.fromCharCode(65 + i));
            }
            
            const numEdges = numNodes + Math.floor(Math.random() * numNodes);
            const existingEdges = new Set();
            for (let i = 0; i < numEdges; i++) {
                const from = Math.floor(Math.random() * numNodes);
                let to = Math.floor(Math.random() * numNodes);
                const edgeKey1 = `${from}-${to}`;
                const edgeKey2 = `${to}-${from}`;

                if (from !== to && !existingEdges.has(edgeKey1)) {
                    drawer.addEdge(from, to);
                    existingEdges.add(edgeKey1);
                    existingEdges.add(edgeKey2);
                }
            }
            drawer.draw();
            return drawer;
        };
        
        // Demo de Grados
        document.getElementById('generateGraphBtn').addEventListener('click', () => {
             generateRandomGraphForDemo(degreeDemoDrawer);
             updateGraphStats(degreeDemoDrawer);
        });
        document.getElementById('showDegreesBtn').addEventListener('click', () => showDegrees(degreeDemoDrawer));

        // Demo del Apretón de Manos
        document.getElementById('verifyHandshakeBtn').addEventListener('click', () => verifyHandshake(handshakeDemoDrawer));
        document.getElementById('showParityBtn').addEventListener('click', () => checkParity(handshakeDemoDrawer));

        // Generar grafos iniciales para las demos
        generateRandomGraphForDemo(degreeDemoDrawer);
        updateGraphStats(degreeDemoDrawer);
        generateRandomGraphForDemo(handshakeDemoDrawer);

    });

    // --- FUNCIONES AUXILIARES Y CLASES ---

    function createBubbles() {
        const bubblesContainer = document.getElementById('bubbles');
        if(!bubblesContainer) return;
        
        setInterval(() => {
            const bubble = document.createElement('div');
            bubble.classList.add('bubble');
            
            const size = Math.random() * 60 + 20;
            const posX = Math.random() * window.innerWidth;
            const duration = Math.random() * 10 + 15;
            
            bubble.style.width = `${size}px`;
            bubble.style.height = `${size}px`;
            bubble.style.left = `${posX}px`;
            bubble.style.animationDuration = `${duration}s`;
            
            bubblesContainer.appendChild(bubble);
            
            setTimeout(() => bubble.remove(), duration * 1000);
        }, 350);
    }

    class GraphDrawer {
        constructor(canvas) {
            this.canvas = canvas;
            this.ctx = canvas.getContext('2d');
            this.nodes = [];
            this.edges = [];
            this.nodeRadius = 20;
            this.degrees = [];
        }

        addNode(x, y, label = '') {
            this.nodes.push({ x, y, label });
        }

        addEdge(from, to, weight = null) {
            this.edges.push({ from, to, weight });
        }

        clear() {
            this.nodes = [];
            this.edges = [];
            this.degrees = [];
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        }

        getDegrees() {
            this.degrees = new Array(this.nodes.length).fill(0);
            this.edges.forEach(edge => {
                this.degrees[edge.from]++;
                this.degrees[edge.to]++;
            });
            return this.degrees;
        }

        draw(highlightOdd = false) {
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            const isDarkMode = document.body.getAttribute('data-theme') === 'dark';
            
            // Dibujar aristas
            this.edges.forEach(edge => {
                const fromNode = this.nodes[edge.from];
                const toNode = this.nodes[edge.to];
                
                this.ctx.beginPath();
                this.ctx.moveTo(fromNode.x, fromNode.y);
                this.ctx.lineTo(toNode.x, toNode.y);
                this.ctx.strokeStyle = isDarkMode ? '#a0aec0' : '#718096';
                this.ctx.lineWidth = 2.5;
                this.ctx.stroke();

                // Dibujar peso
                if (edge.weight !== null) {
                    const midX = (fromNode.x + toNode.x) / 2;
                    const midY = (fromNode.y + toNode.y) / 2;
                    this.ctx.fillStyle = '#e53e3e';
                    this.ctx.font = 'bold 12px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.textBaseline = 'middle';
                    this.ctx.fillRect(midX - 12, midY - 10, 24, 20);
                    this.ctx.fillStyle = 'white';
                    this.ctx.fillText(edge.weight, midX, midY);
                }
            });

            // Dibujar nodos
            this.nodes.forEach((node, index) => {
                const degree = this.degrees[index];
                const isOdd = degree % 2 !== 0;

                this.ctx.beginPath();
                this.ctx.arc(node.x, node.y, this.nodeRadius, 0, 2 * Math.PI);
                this.ctx.fillStyle = (highlightOdd && isOdd) ? '#ed8936' : '#4299e1';
                this.ctx.fill();
                this.ctx.strokeStyle = isDarkMode ? '#1a202c' : '#ffffff';
                this.ctx.lineWidth = 3;
                this.ctx.stroke();

                // Etiqueta (Label o Grado)
                this.ctx.fillStyle = 'white';
                this.ctx.font = 'bold 14px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.textBaseline = 'middle';
                this.ctx.fillText(degree !== undefined ? degree : node.label, node.x, node.y);
            });
        }
        
        // --- Métodos para dibujar grafos específicos ---
        
        drawSimpleGraph() {
            this.clear();
            const w = this.canvas.width, h = this.canvas.height;
            this.addNode(w * 0.25, h * 0.5, 'A');
            this.addNode(w * 0.75, h * 0.25, 'B');
            this.addNode(w * 0.75, h * 0.75, 'C');
            this.addEdge(0, 1); this.addEdge(1, 2); this.addEdge(0, 2);
            this.draw();
        }

        drawMultiGraph() {
            this.clear();
            const w = this.canvas.width, h = this.canvas.height;
            this.addNode(w * 0.3, h * 0.5, 'A');
            this.addNode(w * 0.7, h * 0.5, 'B');
            this.draw(); // Dibuja los nodos primero

            const fromNode = this.nodes[0], toNode = this.nodes[1];
            
            // Arista 1 (curva superior)
            this.ctx.beginPath(); this.ctx.moveTo(fromNode.x, fromNode.y);
            this.ctx.quadraticCurveTo(w * 0.5, h * 0.1, toNode.x, toNode.y);
            this.ctx.strokeStyle = '#38b2ac'; this.ctx.lineWidth = 3; this.ctx.stroke();
            
            // Arista 2 (recta)
            this.ctx.beginPath(); this.ctx.moveTo(fromNode.x, fromNode.y);
            this.ctx.lineTo(toNode.x, toNode.y);
            this.ctx.strokeStyle = '#4299e1'; this.ctx.lineWidth = 3; this.ctx.stroke();
            
            // Arista 3 (curva inferior)
            this.ctx.beginPath(); this.ctx.moveTo(fromNode.x, fromNode.y);
            this.ctx.quadraticCurveTo(w * 0.5, h * 0.9, toNode.x, toNode.y);
            this.ctx.strokeStyle = '#9f7aea'; this.ctx.lineWidth = 3; this.ctx.stroke();
            
             // Re-dibujar nodos para que estén encima de las aristas
             this.nodes.forEach(node => {
                this.ctx.beginPath(); this.ctx.arc(node.x, node.y, this.nodeRadius, 0, 2 * Math.PI);
                this.ctx.fillStyle = '#4299e1'; this.ctx.fill();
                this.ctx.strokeStyle = '#ffffff'; this.ctx.lineWidth = 3; this.ctx.stroke();
                this.ctx.fillStyle = 'white'; this.ctx.font = 'bold 14px Arial';
                this.ctx.textAlign = 'center'; this.ctx.textBaseline = 'middle';
                this.ctx.fillText(node.label, node.x, node.y);
            });
        }

        drawWeightedGraph() {
            this.clear();
            const w = this.canvas.width, h = this.canvas.height;
            this.addNode(w * 0.2, h * 0.3, 'A');
            this.addNode(w * 0.8, h * 0.3, 'B');
            this.addNode(w * 0.5, h * 0.8, 'C');
            this.addEdge(0, 1, 5); this.addEdge(1, 2, 3); this.addEdge(0, 2, 8);
            this.draw();
        }

        drawRegularGraph() {
            this.clear();
            const w = this.canvas.width, h = this.canvas.height, numNodes = 6;
            const centerX = w / 2, centerY = h / 2, radius = Math.min(w, h) * 0.35;
            for (let i = 0; i < numNodes; i++) {
                const angle = (i * 2 * Math.PI) / numNodes;
                this.addNode(centerX + radius * Math.cos(angle), centerY + radius * Math.sin(angle), String.fromCharCode(65 + i));
            }
            for (let i = 0; i < numNodes; i++) {
                this.addEdge(i, (i + 1) % numNodes);
                this.addEdge(i, (i + 3) % numNodes);
            }
            this.draw();
        }

        drawIrregularGraph() {
            this.clear();
            const w = this.canvas.width, h = this.canvas.height;
            this.addNode(w * 0.2, h * 0.2, 'A'); // deg=1
            this.addNode(w * 0.5, h * 0.5, 'B'); // deg=3
            this.addNode(w * 0.8, h * 0.2, 'C'); // deg=1
            this.addNode(w * 0.8, h * 0.8, 'D'); // deg=1
            this.addEdge(0, 1); this.addEdge(2, 1); this.addEdge(3, 1);
            this.draw();
        }
    }

    // --- FUNCIONES INTERACTIVAS ---

    function updateGraphStats(drawer) {
        const statsContainer = document.getElementById('graphStats');
        if (!statsContainer) return;

        const degrees = drawer.getDegrees();
        const numNodes = drawer.nodes.length;
        const numEdges = drawer.edges.length;
        const degreeSequence = [...degrees].sort((a, b) => a - b).join(', ');

        statsContainer.innerHTML = `
            <div class="stat-card"><div class="stat-number">${numNodes}</div><div class="stat-label">Vértices</div></div>
            <div class="stat-card"><div class="stat-number">${numEdges}</div><div class="stat-label">Aristas</div></div>
            <div class="stat-card" style="grid-column: 1 / -1;"><div class="stat-number" style="font-size: 1.2rem;">[${degreeSequence}]</div><div class="stat-label">Secuencia de Grados</div></div>
        `;
    }

    function showDegrees(drawer) {
        if (!drawer.nodes.length) return;
        drawer.getDegrees();
        drawer.draw();
    }

    function verifyHandshake(drawer) {
        const resultDiv = document.getElementById('handshakeResult');
        if (!drawer.nodes.length) {
            resultDiv.textContent = "Genera un grafo primero.";
            return;
        }
        
        const degrees = drawer.getDegrees();
        const sumOfDegrees = degrees.reduce((sum, deg) => sum + deg, 0);
        const twoTimesEdges = drawer.edges.length * 2;
        
        resultDiv.innerHTML = `
            Suma de Grados (Σ deg(v)) = <span style="color: #38b2ac;">${sumOfDegrees}</span><br>
            2 x Número de Aristas (2|E|) = <span style="color: #38b2ac;">${twoTimesEdges}</span>
            <br>¡El lema se cumple!
        `;
        drawer.draw();
    }
    
    function checkParity(drawer) {
        const resultDiv = document.getElementById('handshakeResult');
        if (!drawer.nodes.length) {
             resultDiv.textContent = "Genera un grafo primero.";
            return;
        }

        const degrees = drawer.getDegrees();
        const oddDegreeNodes = degrees.filter(deg => deg % 2 !== 0).length;

        resultDiv.innerHTML = `
            Número de vértices con grado impar: <span style="color: #ed8936;">${oddDegreeNodes}</span>
            <br>¡El resultado (${oddDegreeNodes}) es un número par!
        `;
        drawer.draw(true); // Redibujar resaltando los nodos impares
    }

    </script>
</body>
</html>