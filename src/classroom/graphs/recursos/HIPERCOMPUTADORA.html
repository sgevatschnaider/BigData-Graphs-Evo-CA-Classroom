<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>M√°quina de Zeno + M√°quina de Turing (Œ¥) ‚Äî Visualizador Pro</title>

<!-- MathJax v3: renderiza \( ... \), \[ ... \], $ ... $, $$ ... $$ -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true, processEnvironments: true
    },
    chtml: { fontURL: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2' }
  };
</script>
<script defer id="MathJax-script"
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<style>
  :root{
    --g1:#667eea; --g2:#764ba2;
    --accent:#00ff88; --accent2:#43f3ff; --warn:#ffd700; --danger:#ff4d6d;
    --glass:rgba(255,255,255,.10); --border:rgba(255,255,255,.20);
    --ink:#fff;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  body{
    font-family:'Inter',system-ui,Segoe UI,Roboto,sans-serif;
    color:var(--ink); background:linear-gradient(135deg,var(--g1),var(--g2)); min-height:100vh;
    padding:22px; overflow-x:hidden;
  }
  .container{
    max-width:1400px; margin:0 auto; padding:34px; border-radius:22px;
    background:var(--glass); border:1px solid var(--border); backdrop-filter:blur(16px);
    box-shadow:0 20px 50px rgba(0,0,0,.35); position:relative;
  }
  h1{
    text-align:center; margin-bottom:24px; font-weight:900; letter-spacing:.2px;
    font-size:clamp(2rem,5vw,3rem);
    background:linear-gradient(45deg,#fff,var(--accent)); -webkit-background-clip:text;
    background-clip:text; -webkit-text-fill-color:transparent;
  }
  /* Controles */
  .controls{display:flex;flex-wrap:wrap;gap:14px;justify-content:center;align-items:center;margin-bottom:22px}
  .pill{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:12px;background:var(--glass);border:1px solid var(--border)}
  button{
    padding:12px 20px;border:0;border-radius:12px;cursor:pointer;color:#fff;font-weight:800;
    background:linear-gradient(45deg,#ff6b6b,#ee5a52); box-shadow:0 8px 22px rgba(0,0,0,.2);
    position:relative; overflow:hidden; transition:transform .25s ease;
  }
  button:hover{transform:translateY(-2px)}
  button::before{content:'';position:absolute;inset:0;left:-100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.35),transparent);transition:left .5s}
  button:hover::before{left:100%}
  select,input[type="number"]{
    appearance:none;background:rgba(0,0,0,.25);color:#fff;border:1px solid rgba(255,255,255,.15);
    padding:10px 12px;border-radius:10px;font-weight:600;outline:none;
  }
  input[type="range"]{width:160px;height:6px;background:rgba(255,255,255,.2);border-radius:3px;outline:none;-webkit-appearance:none}
  input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--accent);
    box-shadow:0 2px 10px rgba(0,255,136,.5);
  }
  /* Tarjetas m√©tricas */
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px;margin-bottom:18px}
  .card{background:var(--glass);border:1px solid var(--border);border-radius:14px;padding:16px 18px;position:relative}
  .card::before{content:'';position:absolute;left:0;right:0;top:0;height:3px;background:linear-gradient(90deg,var(--accent),var(--warn))}
  .card h3{font-size:13px;opacity:.9;margin-bottom:4px}
  .value{font-size:1.9em;font-weight:900;color:var(--accent);text-shadow:0 0 12px rgba(0,255,136,.35)}
  /* Visual principal */
  .visual{background:rgba(0,0,0,.40);border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:20px;margin-bottom:16px}
  .section-title{font-weight:900;margin-bottom:10px}
  /* Barras de convergencia */
  .timegrid{display:grid;grid-template-columns:1fr;gap:12px}
  .timeline{position:relative;height:110px;border-radius:12px;overflow:hidden;border:2px solid rgba(255,255,255,.18);background:rgba(255,255,255,.08)}
  .fill{position:absolute;inset:0 0 0 auto;width:0%;background:linear-gradient(90deg,var(--accent),#00cc6a,var(--warn));
    box-shadow:inset 0 0 18px rgba(255,255,255,.18);transition:width .35s}
  .fill.ss{background:linear-gradient(90deg,#7aedff,#35d6ff,#00a8ff)}
  .stripes{position:absolute;inset:0;background:repeating-linear-gradient(45deg,rgba(255,255,255,.22) 0 10px,transparent 10px 20px);mix-blend-mode:overlay;pointer-events:none}
  .centerText{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-weight:900;text-shadow:2px 2px 4px rgba(0,0,0,.75)}
  /* Estado HALT */
  .halt{margin:12px 0;padding:16px;border-radius:12px;text-align:center;font-weight:900;backdrop-filter:blur(10px);transition:all .3s}
  .u{background:rgba(255,165,0,.18);border:2px solid orange;box-shadow:0 0 18px rgba(255,165,0,.28)}
  .y{background:rgba(0,255,0,.18);border:2px solid #00ff00;box-shadow:0 0 18px rgba(0,255,0,.28);animation:pulse 2s infinite}
  .n{background:rgba(255,0,0,.18);border:2px solid #ff0000;box-shadow:0 0 18px rgba(255,0,0,.28)}
  @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}
  /* Cinta MT */
  .tape{display:flex;gap:6px;align-items:center;overflow-x:auto;scroll-behavior:smooth;padding:10px;border-radius:12px;background:rgba(0,0,0,.28);border:1px solid rgba(255,255,255,.12)}
  .cell{
    min-width:34px;height:34px;display:grid;place-items:center;border-radius:8px;
    border:1px solid rgba(255,255,255,.18);
    background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.02));
    font-family:'Fira Code',ui-monospace,monospace;font-weight:800;color:#e8f7ff
  }
  .head{position:relative;box-shadow:0 0 14px rgba(0,255,136,.55)}
  .head::after{
    content:"‚ñ≤";position:absolute;top:-14px;left:50%;transform:translateX(-50%);
    color:var(--accent);font-size:11px;text-shadow:0 0 8px rgba(0,255,136,.85)
  }
  /* Reloj */
  .clock-wrap{display:flex;justify-content:center;align-items:center;margin-top:12px}
  .clock{position:relative;width:260px;height:260px;border-radius:50%;
    background:radial-gradient(circle,rgba(0,0,0,.78),rgba(0,0,0,.45));
    border:4px solid var(--accent);box-shadow:0 0 36px rgba(0,255,136,.55), inset 0 0 36px rgba(0,255,136,.25);
    animation:glow 3s ease-in-out infinite alternate}
  @keyframes glow{from{box-shadow:0 0 36px rgba(0,255,136,.55), inset 0 0 36px rgba(0,255,136,.25)}to{box-shadow:0 0 56px rgba(0,255,136,.85), inset 0 0 56px rgba(0,255,136,.35)}}
  .hand{position:absolute;bottom:50%;left:50%;width:4px;height:42%;
    background:linear-gradient(to top,var(--accent),var(--warn));transform-origin:bottom center;border-radius:2px;transition:transform .12s ease;box-shadow:0 0 10px rgba(0,255,136,.8)}
  .hub{position:absolute;top:50%;left:50%;width:12px;height:12px;background:var(--warn);border-radius:50%;transform:translate(-50%,-50%);box-shadow:0 0 15px rgba(255,215,0,.9)}
  .numbers{position:absolute;inset:0;pointer-events:none}
  .num{position:absolute;transform:translate(-50%,-50%);font-weight:900;color:var(--accent);text-shadow:0 0 6px rgba(0,255,136,.45);font-size:14px}
  .tick{position:absolute;left:50%;top:50%;width:2px;height:8px;background:rgba(255,255,255,.35);transform-origin:bottom center;border-radius:1px}
  .tick.major{height:12px;background:#fff}
  /* Fundamentos (MathJax) */
  .math{background:rgba(0,0,0,.5);padding:18px;border-radius:12px;margin-top:10px;border-left:5px solid var(--warn);transform:translateY(14px);opacity:0;transition:all .4s}
  .math.visible{transform:translateY(0);opacity:1}
  .formula{font-family:'Fira Code',monospace;color:var(--warn);text-align:center;padding:8px;margin:8px 0;background:rgba(255,215,0,.10);border:1px solid rgba(255,215,0,.28);border-radius:8px}
  .formula mjx-container{filter:drop-shadow(0 2px 6px rgba(0,0,0,.25))}
  /* Historial */
  .list{max-height:220px;overflow:auto;background:rgba(0,0,0,.3);border-radius:12px;border:1px solid rgba(255,255,255,.1);padding:12px}
  .item{padding:8px 10px;margin:4px 0;background:var(--glass);border-left:3px solid var(--accent);border-radius:8px;font-family:'Fira Code',monospace;font-size:.92em}
  /* Part√≠culas */
  .particle{position:absolute;width:4px;height:4px;background:radial-gradient(circle,rgba(255,255,255,.85),transparent);border-radius:50%;pointer-events:none;animation:float 6s infinite ease-in-out}
  @keyframes float{
    0%,100%{transform:translateY(0) translateX(0) scale(1);opacity:.3}
    25%{transform:translateY(-30px) translateX(10px) scale(1.2);opacity:.8}
    50%{transform:translateY(-60px) translateX(-10px) scale(.8);opacity:1}
    75%{transform:translateY(-30px) translateX(15px) scale(1.1);opacity:.6}
  }
  @media (max-width:768px){
    .container{padding:20px}
    .clock{width:220px;height:220px}
  }
</style>
</head>
<body>
<div class="container">
  <h1>‚ö° M√°quina de Zeno + M√°quina de Turing (Œ¥)</h1>

  <div class="controls">
    <button id="play"><span id="pIcon">‚ñ∂Ô∏è</span> <span id="pTxt">Iniciar</span></button>
    <button id="reset">üîÑ Reiniciar</button>
    <button id="mathBtn">üìä Matem√°ticas</button>
    <button id="export">üíæ Exportar</button>

    <div class="pill">
      <strong>Velocidad</strong>
      <input type="range" id="speed" min="0.1" max="5" step="0.1" value="1">
      <span id="speedVal">1.0x</span>
    </div>

    <div class="pill">
      <strong>Modo</strong>
      <select id="mode">
        <option value="zeno">Zeno (‚Üí 2s)</option>
        <option value="ssca">Zig-zag SSCA (‚Üí 6u)</option>
      </select>
    </div>

    <div class="pill">
      <strong>MT</strong>
      <select id="kind">
        <option value="haltN">Escribir N unos y HALT</option>
        <option value="loop">Right-walker (no HALT)</option>
      </select>
      <strong>N</strong>
      <input id="n" type="number" min="1" max="64" value="8"/>
    </div>
  </div>

  <div class="grid">
    <div class="card"><h3>üìä Paso MT</h3><div class="value" id="vStep">0</div></div>
    <div class="card"><h3>‚è±Ô∏è Duraci√≥n del paso</h3><div class="value" id="vDur">1.000s</div></div>
    <div class="card"><h3>‚è≤Ô∏è Acumulado (Zeno)</h3><div class="value" id="vT2">0.000 / 2</div></div>
    <div class="card"><h3>üéØ Acumulado (SSCA)</h3><div class="value" id="vT6">0.000 / 6</div></div>
  </div>

  <div class="visual">
    <div class="section-title">üåä Convergencia temporal</div>
    <div class="timegrid">
      <div class="timeline">
        <div class="fill" id="f2"></div>
        <div class="stripes"></div>
        <div class="centerText" id="t2txt">0.00% ‚Üí 2s</div>
      </div>
      <div class="timeline">
        <div class="fill ss" id="f6"></div>
        <div class="stripes"></div>
        <div class="centerText" id="t6txt">0.00% ‚Üí 6u</div>
      </div>
    </div>

    <div class="halt u" id="halt">ü§î Inicializando MT‚Ä¶</div>

    <div class="tape" id="tape"></div>

    <div class="clock-wrap">
      <div class="clock" id="clock">
        <div class="numbers" id="nums"></div>
        <div class="hand" id="hand"></div>
        <div class="hub"></div>
      </div>
    </div>
  </div>

  <div class="visual">
    <div class="section-title">üìú Fundamentos</div>
    <div class="math" id="math">
      <div class="formula">Zeno: \(t_k = 2^{-k}\), \(\sum_{i=0}^{\infty} 2^{-i} = 2\)</div>
      <div class="formula">SSCA: \(3\cdot 2^{-k}\), \(\sum_{i=0}^{\infty} 3\cdot 2^{-i} = 6\)</div>
      <div class="formula">\(T_2(n)=2\bigl(1-2^{-n}\bigr)\), \(T_6(n)=6\bigl(1-2^{-n}\bigr)\)</div>
      <div class="formula">Si la MT para en \(N\), lo hace antes de \(2\text{s}\) / \(6\text{u}\).</div>
    </div>
  </div>

  <div class="visual">
    <div class="section-title">üìú Historial</div>
    <div class="list" id="log"><div class="item">üöÄ Listo</div></div>
  </div>
</div>

<script>
/* ========= Part√≠culas ========= */
(function(){const c=document.querySelector('.container');for(let i=0;i<24;i++){const p=document.createElement('div');p.className='particle';p.style.left=Math.random()*100+'%';p.style.top=Math.random()*100+'%';p.style.animationDuration=(5+Math.random()*6)+'s';c.appendChild(p);}})();

/* ========= Utilidades geom√©tricas ========= */
const durZ = k => 2**(-k);
const durS = k => 3*2**(-k);
const T2   = n => 2*(1-2**(-n));
const T6   = n => 6*(1-2**(-n));
const pct  = (x,lim)=> Math.min(100, 100*x/lim);
const fmtT = t => t<1e-3? (t*1e6).toFixed(2)+'Œºs' : (t<1? (t*1e3).toFixed(3)+'ms' : t.toFixed(6)+'s');

/* ========= M√°quina de Turing ========= */
class TM{
  constructor(blank='_'){this.blank=blank;this.reset();}
  reset(tapeInit=['_'], start='q'){this.t=new Map();tapeInit.forEach((s,i)=>{if(s!==this.blank)this.t.set(i,s)});this.h=0;this.q=start;this.H=new Set(['HALT']);this.k=0;this.delta={};}
  read(){return this.t.has(this.h)?this.t.get(this.h):this.blank;}
  write(s){if(s===this.blank)this.t.delete(this.h);else this.t.set(this.h,s);}
  step(){
    if(this.H.has(this.q)) return true;
    const s=this.read(), row=this.delta[this.q]||{}, tr=row[s];
    if(!tr){ this.q='HALT'; return true; }
    const [w,m,qn]=tr; this.write(w); this.h+=(m==='R'?1:-1); this.q=qn; this.k++;
    return this.H.has(this.q);
  }
  view(center=this.h, R=18){
    const cells=[]; for(let x=center-R;x<=center+R;x++){const s=this.t.has(x)?this.t.get(x):this.blank;cells.push({x,s,head:x===this.h});}
    return cells;
  }
}
function makeWriteNOnes(N){
  const tm=new TM('_'); tm.q='q'+N; tm.delta={};
  for(let k=N;k>=1;k--){
    tm.delta['q'+k]={'_':['1','R',(k-1===0?'HALT':'q'+(k-1))],'1':['1','R',(k-1===0?'HALT':'q'+(k-1))]};
  } return tm;
}
function makeRightWalker(){ const tm=new TM('_'); tm.q='q'; tm.delta={'q':{'_':['_','R','q'],'1':['1','R','q']}}; return tm; }

/* ========= UI ========= */
const $ = s=>document.querySelector(s);
const ui={
  play:$('#play'), pIcon:$('#pIcon'), pTxt:$('#pTxt'), reset:$('#reset'), export:$('#export'),
  mathBtn:$('#mathBtn'), math:$('#math'),
  mode:$('#mode'), speed:$('#speed'), speedVal:$('#speedVal'),
  kind:$('#kind'), n:$('#n'),
  vStep:$('#vStep'), vDur:$('#vDur'), vT2:$('#vT2'), vT6:$('#vT6'),
  f2:$('#f2'), f6:$('#f6'), t2txt:$('#t2txt'), t6txt:$('#t6txt'),
  halt:$('#halt'), tape:$('#tape'),
  clock:$('#clock'), hand:$('#hand'), nums:$('#nums'),
  log:$('#log')
};
const S={running:false,started:false,mode:'zeno',speed:1,k:0,tm:null,tTO:null,cTO:null,thr2:1.9999,thr6:5.9999,maxK:2048,data:[], zStep:0};

/* ========= Reloj: n√∫meros + marcas ========= */
function buildClock(){
  const rect=ui.clock.getBoundingClientRect();
  const cx=rect.width/2, cy=rect.height/2, r=Math.min(cx,cy)-18;
  ui.nums.innerHTML='';
  // marcas
  for(let i=0;i<60;i++){
    const tick=document.createElement('div'); tick.className='tick'+(i%5===0?' major':'');
    const angle=(i/60)*360; tick.style.transform=`translate(-50%,-100%) rotate(${angle}deg) translateY(${-r}px)`;
    ui.nums.appendChild(tick);
  }
  // n√∫meros 1..12
  for(let n=1;n<=12;n++){
    const el=document.createElement('div'); el.className='num'; el.textContent=n;
    const theta=(n/12)*2*Math.PI - Math.PI/2;
    el.style.left=(cx + Math.cos(theta)* (r-12))+'px';
    el.style.top =(cy + Math.sin(theta)* (r-12))+'px';
    ui.nums.appendChild(el);
  }
}
window.addEventListener('resize', buildClock);
function tickClock(){
  const dt = durZ(S.zStep) * 1000 / S.speed; // mano avanza en semitonos geom√©tricos (visual)
  S.cTO=setTimeout(()=>{ const ang=(S.zStep*30)%360; ui.hand.style.transform=`rotate(${ang}deg)`; S.zStep++; if(S.running) tickClock(); }, dt);
}

/* ========= Render cinta / paneles ========= */
function renderTape(){
  const cells=S.tm.view(S.tm.h,18); ui.tape.innerHTML='';
  for(const c of cells){ const d=document.createElement('div'); d.className='cell'+(c.head?' head':''); d.textContent=c.s; ui.tape.appendChild(d); }
  // autoscroll hacia el cabezal
  const idx=18; const child=ui.tape.children[idx]; if(child){ const off=child.offsetLeft - ui.tape.clientWidth/2 + child.clientWidth/2; ui.tape.scrollLeft=off; }
}
function renderPanels(){
  const t2=T2(S.k), t6=T6(S.k);
  ui.vStep.textContent=S.tm.k;
  ui.vDur.textContent=fmtT(S.mode==='zeno'?durZ(S.k):durS(S.k));
  ui.vT2.textContent=`${t2.toFixed(6)} / 2`;
  ui.vT6.textContent=`${t6.toFixed(6)} / 6`;
  ui.f2.style.width=pct(t2,2)+'%'; ui.f6.style.width=pct(t6,6)+'%';
  ui.t2txt.textContent=pct(t2,2).toFixed(2)+'% ‚Üí 2s';
  ui.t6txt.textContent=pct(t6,6).toFixed(2)+'% ‚Üí 6u';
}

/* ========= Log / HALT ========= */
function log(m){ const it=document.createElement('div'); it.className='item'; it.textContent=m; ui.log.appendChild(it); ui.log.scrollTop=ui.log.scrollHeight; if(ui.log.children.length>80) ui.log.removeChild(ui.log.firstChild); }
function setHalt(state,msg){ ui.halt.className='halt '+(state==='y'?'y':state==='n'?'n':'u'); ui.halt.innerHTML=msg; }

/* ========= Scheduler ========= */
function schedule(){ if(!S.running) return; const dt=(S.mode==='zeno'?durZ(S.k):durS(S.k))*1000/S.speed; S.tTO=setTimeout(stepOnce,dt); }
function stepOnce(){
  const halted=S.tm.step(); S.k++;
  renderTape(); renderPanels();
  S.data.push({k:S.k,step:S.tm.k,t2:T2(S.k),t6:T6(S.k),mode:S.mode});
  if(halted){ setHalt('y','‚úÖ HALT alcanzado en paso MT '+S.tm.k); toggle(false); return; }
  if( (S.mode==='zeno' && T2(S.k)>=S.thr2) || (S.mode==='ssca' && T6(S.k)>=S.thr6) || S.k>=S.maxK ){
    setHalt('n','‚ö° Supertarea completada (l√≠mite alcanzado sin HALT)'); toggle(false); return;
  }
  schedule();
}

/* ========= Controles ========= */
function toggle(on){
  S.running=(on!==undefined?on:!S.running);
  ui.pIcon.textContent=S.running?'‚è∏Ô∏è':'‚ñ∂Ô∏è'; ui.pTxt.textContent=S.running?(S.started?'Pausar':'Iniciar'):(S.started?'Continuar':'Iniciar');
  if(S.running){ if(!S.started){ S.started=true; log('‚ñ∂Ô∏è Inicio de simulaci√≥n'); } schedule(); tickClock(); }
  else { clearTimeout(S.tTO); clearTimeout(S.cTO); }
}
function reset(){
  clearTimeout(S.tTO); clearTimeout(S.cTO);
  S.running=false; S.started=false; S.k=0; S.zStep=0; S.data=[];
  const kind=ui.kind.value, N=Math.max(1,Math.min(64,+ui.n.value));
  S.tm=(kind==='haltN')?makeWriteNOnes(N):makeRightWalker();
  ui.pIcon.textContent='‚ñ∂Ô∏è'; ui.pTxt.textContent='Iniciar';
  setHalt('u','ü§î Inicializando MT‚Ä¶');
  renderTape(); renderPanels(); ui.hand.style.transform='rotate(0deg)';
  ui.log.innerHTML='<div class="item">üöÄ Listo</div>';
}
function exportCSV(){
  let csv='k,mtStep,T2,T6,mode\n'; S.data.forEach(d=>csv+=`${d.k},${d.step},${d.t2},${d.t6},${d.mode}\n`);
  const blob=new Blob([csv],{type:'text/csv'}), url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='zeno_mt.csv'; a.click(); URL.revokeObjectURL(url);
}

/* ========= Eventos ========= */
ui.play.onclick = ()=>toggle();
ui.reset.onclick= reset;
ui.export.onclick= exportCSV;
ui.speed.oninput = e=>{ S.speed=parseFloat(e.target.value); ui.speedVal.textContent=S.speed.toFixed(1)+'x'; };
ui.mode.onchange = e=>{ S.mode=e.target.value; renderPanels(); };
ui.kind.onchange = reset;
ui.n.oninput    = reset;
ui.mathBtn.onclick = async ()=>{
  ui.math.classList.toggle('visible');
  if(window.MathJax && ui.math.classList.contains('visible')){
    await MathJax.typesetPromise([ui.math]);
  }
};

/* ========= Init ========= */
(function init(){
  S.speed=parseFloat(ui.speed.value); ui.speedVal.textContent=S.speed.toFixed(1)+'x';
  buildClock(); reset();
  if(window.MathJax){ MathJax.typesetPromise([ui.math]); }
})();
</script>
</body>
</html>

>
